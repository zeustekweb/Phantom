<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#0a0a0f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Phantom">
<meta name="mobile-web-app-capable" content="yes">
<meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, private">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
<meta name="referrer" content="no-referrer">
<title>Phantom</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#08080f;--bg2:#0d0d18;--bg3:#12121f;--bg4:#181828;
  --border:rgba(255,255,255,0.05);--border2:rgba(255,255,255,0.1);
  --accent:#7c3aed;--accent2:#a855f7;--accent3:#c084fc;
  --green:#22c55e;--green2:#4ade80;--red:#ef4444;--amber:#f59e0b;
  --text:#e2e8f0;--text2:#94a3b8;--text3:#475569;
  --sat:env(safe-area-inset-top,0px);--sab:env(safe-area-inset-bottom,0px);
  --sal:env(safe-area-inset-left,0px);--sar:env(safe-area-inset-right,0px);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:var(--bg);color:var(--text);
  font-family:'Syne',sans-serif;overscroll-behavior:none;-webkit-overflow-scrolling:touch;
  -webkit-user-select:none;user-select:none;}
body::after{content:'';position:fixed;top:-20vh;left:50%;transform:translateX(-50%);
  width:100vw;height:70vh;
  background:radial-gradient(ellipse,rgba(124,58,237,.07) 0%,transparent 65%);
  pointer-events:none;z-index:0;}
body::before{content:'';position:fixed;inset:0;z-index:1000;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events:none;opacity:.5;}
.screen{position:fixed;inset:0;z-index:10;display:flex;align-items:center;justify-content:center;
  padding:calc(var(--sat) + 16px) calc(var(--sar) + 16px) calc(var(--sab) + 16px) calc(var(--sal) + 16px);
  transition:opacity .3s ease,transform .3s ease;overflow-y:auto;-webkit-overflow-scrolling:touch;}
.screen.hidden{opacity:0;pointer-events:none;transform:translateY(12px);}
.screen-inner{width:100%;max-width:420px;display:flex;flex-direction:column;align-items:center;padding:12px 0 28px;}

/* HOME */
#homeScreen{flex-direction:column;}
.logo-wrap{display:flex;flex-direction:column;align-items:center;margin-bottom:28px;}
.logo-svg-container{width:min(70px,18vw);height:min(70px,18vw);margin-bottom:18px;flex-shrink:0;}
.logo-svg-container svg{width:100%;height:100%;}
.logo-ring{animation:spinRing 10s linear infinite;transform-origin:32px 32px;}
@keyframes spinRing{to{transform:rotate(360deg)}}
h1{font-size:clamp(2rem,9vw,3.8rem);font-weight:800;letter-spacing:-.04em;line-height:1;
  background:linear-gradient(135deg,#fff 0%,var(--accent3) 55%,var(--accent) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  margin-bottom:9px;text-align:center;}
.tagline{font-family:'Space Mono',monospace;font-size:clamp(.58rem,2.4vw,.7rem);
  color:var(--text3);letter-spacing:.14em;text-transform:uppercase;text-align:center;}
.home-actions{display:flex;flex-direction:column;gap:10px;width:100%;margin-top:32px;}

/* BUTTONS */
.btn{display:flex;align-items:center;justify-content:center;gap:9px;padding:15px 22px;
  border-radius:14px;font-family:'Syne',sans-serif;font-size:clamp(.88rem,3.5vw,.95rem);
  font-weight:700;cursor:pointer;border:none;transition:all .18s ease;
  position:relative;overflow:hidden;-webkit-tap-highlight-color:transparent;min-height:52px;}
.btn:active{transform:scale(.97);}
.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;
  box-shadow:0 0 26px rgba(124,58,237,.28),0 4px 14px rgba(0,0,0,.25);}
.btn-secondary{background:var(--bg3);color:var(--text);border:1px solid var(--border2);}
.btn-ghost{background:transparent;color:var(--text2);border:1px solid var(--border);font-size:.85rem;}
.btn-danger{background:rgba(239,68,68,.08);color:var(--red);border:1px solid rgba(239,68,68,.2);}

.badges{display:flex;gap:6px;flex-wrap:wrap;justify-content:center;margin-top:26px;}
.badge{font-family:'Space Mono',monospace;font-size:clamp(.5rem,1.9vw,.6rem);
  letter-spacing:.07em;text-transform:uppercase;padding:4px 9px;
  border-radius:20px;border:1px solid var(--border2);color:var(--text3);}
.badge.green{border-color:rgba(34,197,94,.28);color:var(--green);}
.badge.amber{border-color:rgba(245,158,11,.28);color:var(--amber);}

/* CARD */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:22px;
  padding:clamp(18px,5vw,30px);width:100%;position:relative;overflow:hidden;}
.card::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);
  width:55%;height:1px;background:linear-gradient(90deg,transparent,var(--accent2),transparent);}
.card-title{font-size:clamp(1.05rem,4vw,1.25rem);font-weight:700;margin-bottom:5px;}
.card-sub{font-family:'Space Mono',monospace;font-size:clamp(.6rem,2.4vw,.68rem);
  color:var(--text3);margin-bottom:20px;letter-spacing:.04em;line-height:1.5;}

/* QR */
.qr-wrapper{background:#fff;border-radius:14px;padding:10px;width:fit-content;
  margin:0 auto 16px;box-shadow:0 0 38px rgba(124,58,237,.2),0 0 0 1px rgba(124,58,237,.1);
  position:relative;overflow:hidden;}
#qrCanvas{display:block;border-radius:6px;}
.scan-line{position:absolute;left:10px;right:10px;height:2px;
  background:linear-gradient(90deg,transparent,rgba(124,58,237,.7),transparent);
  animation:scan 2.2s ease-in-out infinite;}
@keyframes scan{0%,100%{top:13px;opacity:0}10%{opacity:1}90%{opacity:1}50%{top:calc(100% - 13px)}}

.divider{display:flex;align-items:center;gap:10px;margin:14px 0;
  color:var(--text3);font-family:'Space Mono',monospace;font-size:.65rem;}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border);}

.code-display{background:var(--bg3);border:1px solid var(--border2);border-radius:12px;
  padding:12px 15px;display:flex;align-items:center;justify-content:space-between;
  gap:10px;margin-bottom:12px;}
.code-text{font-family:'Space Mono',monospace;font-size:clamp(.88rem,3.5vw,1.05rem);
  font-weight:700;letter-spacing:.1em;color:var(--accent3);word-break:break-all;
  -webkit-user-select:text;user-select:text;}
.copy-btn{background:rgba(124,58,237,.13);border:1px solid rgba(124,58,237,.28);
  color:var(--accent3);border-radius:8px;padding:6px 11px;
  font-family:'Space Mono',monospace;font-size:.6rem;cursor:pointer;
  transition:all .2s;white-space:nowrap;-webkit-tap-highlight-color:transparent;min-height:34px;}
.copy-btn.copied{background:rgba(34,197,94,.12);border-color:rgba(34,197,94,.28);color:var(--green);}

.timer-bar{height:2px;background:var(--border);border-radius:2px;overflow:hidden;margin-bottom:6px;}
.timer-fill{height:100%;border-radius:2px;transition:width 1s linear,background 1s;}
.timer-text{font-family:'Space Mono',monospace;font-size:.63rem;color:var(--text3);text-align:center;margin-bottom:14px;}
.timer-text span{color:var(--text2);}
.waiting{display:flex;align-items:center;justify-content:center;gap:8px;color:var(--text2);font-size:.82rem;}
.dot-pulse{display:flex;gap:4px;}
.dot-pulse span{width:5px;height:5px;border-radius:50%;background:var(--accent2);animation:pulse 1.4s ease-in-out infinite;}
.dot-pulse span:nth-child(2){animation-delay:.2s}.dot-pulse span:nth-child(3){animation-delay:.4s}
@keyframes pulse{0%,80%,100%{transform:scale(.6);opacity:.35}40%{transform:scale(1);opacity:1}}

/* INPUTS */
.input-label{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--text3);
  letter-spacing:.1em;text-transform:uppercase;margin-bottom:7px;}
.input-field{width:100%;background:var(--bg3);border:1px solid var(--border2);border-radius:12px;
  padding:14px 15px;font-family:'Space Mono',monospace;
  font-size:clamp(.98rem,3.8vw,1.1rem);font-weight:700;color:var(--text);
  outline:none;transition:border-color .2s,box-shadow .2s;
  letter-spacing:.09em;text-transform:uppercase;}
.input-field::placeholder{color:var(--text3);font-weight:400;letter-spacing:.05em;text-transform:none;}
.input-field:focus{border-color:var(--accent2);box-shadow:0 0 0 3px rgba(124,58,237,.1);}
.error-msg{font-family:'Space Mono',monospace;font-size:.66rem;color:var(--red);margin-top:7px;min-height:16px;}

/* PASSPHRASE */
.pw-input{width:100%;background:var(--bg3);border:1px solid var(--border2);border-radius:12px;
  padding:14px 15px;font-family:'Space Mono',monospace;font-size:1rem;color:var(--text);
  outline:none;letter-spacing:.07em;transition:border-color .2s,box-shadow .2s;}
.pw-input:focus{border-color:var(--accent2);box-shadow:0 0 0 3px rgba(124,58,237,.1);}
.pw-info{font-family:'Space Mono',monospace;font-size:.62rem;color:var(--text3);
  line-height:1.65;margin-bottom:14px;padding:12px;background:var(--bg3);
  border:1px solid var(--border);border-radius:10px;}
.pw-info .hi{color:var(--amber);}
.pw-strength-bar{height:3px;border-radius:2px;margin-top:8px;transition:all .3s;width:0%;}
.pw-strength-label{font-family:'Space Mono',monospace;font-size:.6rem;margin-top:5px;margin-bottom:16px;}

/* CHAT SCREEN */
#chatScreen{padding:0;align-items:stretch;overflow:hidden;}
.chat-outer{display:flex;flex-direction:column;width:100%;height:100%;max-width:680px;margin:0 auto;}
.chat-header{display:flex;align-items:center;gap:11px;
  padding:calc(var(--sat) + 12px) calc(var(--sar) + 16px) 12px calc(var(--sal) + 16px);
  border-bottom:1px solid var(--border);background:rgba(8,8,15,.94);
  backdrop-filter:blur(24px) saturate(1.5);-webkit-backdrop-filter:blur(24px) saturate(1.5);
  flex-shrink:0;z-index:5;}
.status-dot{width:8px;height:8px;border-radius:50%;background:var(--green);
  box-shadow:0 0 7px var(--green);flex-shrink:0;animation:sPulse 2.2s ease-in-out infinite;}
@keyframes sPulse{0%,100%{box-shadow:0 0 5px var(--green)}50%{box-shadow:0 0 13px var(--green2)}}
.chat-info{flex:1;min-width:0;}
.chat-info h3{font-size:clamp(.86rem,3.4vw,.93rem);font-weight:700;
  display:flex;align-items:center;gap:7px;white-space:nowrap;overflow:hidden;}
.e2e-badge{font-family:'Space Mono',monospace;font-size:.5rem;padding:2px 6px;border-radius:4px;
  background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.22);color:var(--green);
  letter-spacing:.05em;flex-shrink:0;}
.chat-info p{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text3);margin-top:2px;}
.chat-actions{display:flex;gap:6px;}
.icon-btn{width:38px;height:38px;border-radius:10px;border:1px solid var(--border);
  background:transparent;color:var(--text3);cursor:pointer;display:flex;align-items:center;
  justify-content:center;transition:all .18s;-webkit-tap-highlight-color:transparent;font-size:.9rem;}
.icon-btn:active{background:var(--bg3);}

/* Inactivity bar */
.inactivity-bar{background:rgba(245,158,11,.07);border-bottom:1px solid rgba(245,158,11,.18);
  padding:7px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px;
  flex-shrink:0;transform:translateY(-100%);transition:transform .25s ease;}
.inactivity-bar.visible{transform:translateY(0);}
.inactivity-bar span{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--amber);}
.inactivity-bar button{font-family:'Space Mono',monospace;font-size:.58rem;
  background:rgba(245,158,11,.12);border:1px solid rgba(245,158,11,.25);
  color:var(--amber);border-radius:6px;padding:4px 10px;cursor:pointer;min-height:30px;
  -webkit-tap-highlight-color:transparent;}

/* Messages */
.messages-area{flex:1;overflow-y:auto;padding:14px 14px 8px;
  display:flex;flex-direction:column;gap:10px;scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;overscroll-behavior:contain;}
.messages-area::-webkit-scrollbar{width:3px;}
.messages-area::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px;}
.msg{max-width:min(74%,340px);animation:mIn .25s ease;}
@keyframes mIn{from{opacity:0;transform:translateY(7px)}to{opacity:1;transform:translateY(0)}}
.msg.mine{align-self:flex-end;}.msg.theirs{align-self:flex-start;}
.msg-bubble{padding:10px 14px;border-radius:17px;font-size:clamp(.87rem,3.5vw,.95rem);
  line-height:1.5;word-break:break-word;-webkit-user-select:text;user-select:text;}
.msg.mine .msg-bubble{background:linear-gradient(135deg,var(--accent),#6d28d9);color:#fff;
  border-bottom-right-radius:4px;box-shadow:0 2px 9px rgba(124,58,237,.22);}
.msg.theirs .msg-bubble{background:var(--bg3);color:var(--text);
  border-bottom-left-radius:4px;border:1px solid var(--border2);}
.msg-destruct-bar{height:2px;background:var(--border);border-radius:1px;margin-top:4px;overflow:hidden;}
.msg-destruct-fill{height:100%;background:var(--red);border-radius:1px;transition:width 1s linear;}
.msg-meta{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--text3);
  margin-top:4px;display:flex;align-items:center;gap:5px;}
.msg.mine .msg-meta{justify-content:flex-end;}
.lock-ico{font-size:.5rem;color:var(--green);}
.system-msg{text-align:center;font-family:'Space Mono',monospace;font-size:.6rem;
  color:var(--text3);padding:5px 14px;background:var(--bg3);
  border:1px solid var(--border);border-radius:20px;align-self:center;max-width:86%;line-height:1.45;}

/* Chat input */
.chat-input-area{padding:8px calc(var(--sar) + 13px) calc(var(--sab) + 9px) calc(var(--sal) + 13px);
  border-top:1px solid var(--border);background:rgba(8,8,15,.94);
  backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);flex-shrink:0;}
.input-toolbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:7px;gap:8px;}
.destruct-toggle{display:flex;align-items:center;gap:6px;cursor:pointer;-webkit-tap-highlight-color:transparent;}
.toggle-track{width:34px;height:18px;border-radius:9px;background:var(--bg4);
  border:1px solid var(--border2);position:relative;transition:background .2s;flex-shrink:0;}
.toggle-thumb{width:12px;height:12px;border-radius:50%;background:var(--text3);
  position:absolute;top:2px;left:2px;transition:all .2s;}
.destruct-toggle.on .toggle-track{background:rgba(239,68,68,.15);border-color:rgba(239,68,68,.3);}
.destruct-toggle.on .toggle-thumb{left:18px;background:var(--red);}
.destruct-label{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text3);}
.destruct-toggle.on .destruct-label{color:var(--red);}
.timer-select{background:var(--bg4);border:1px solid var(--border2);border-radius:7px;
  color:var(--text2);font-family:'Space Mono',monospace;font-size:.58rem;
  padding:3px 7px;outline:none;cursor:pointer;display:none;}
.encrypt-status{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--green);
  display:flex;align-items:center;gap:4px;}
.input-row{display:flex;gap:9px;align-items:flex-end;}
.message-input{flex:1;background:var(--bg3);border:1px solid var(--border2);border-radius:14px;
  padding:12px 14px;font-family:'Syne',sans-serif;font-size:clamp(.9rem,3.5vw,1rem);
  color:var(--text);outline:none;resize:none;min-height:46px;max-height:130px;
  transition:border-color .2s;line-height:1.4;}
.message-input::placeholder{color:var(--text3);}
.message-input:focus{border-color:var(--accent2);}
.send-btn{width:46px;height:46px;border-radius:14px;flex-shrink:0;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;
  color:#fff;font-size:1.15rem;transition:all .18s;
  box-shadow:0 0 16px rgba(124,58,237,.22);-webkit-tap-highlight-color:transparent;}
.send-btn:active{transform:scale(.95);}
.send-btn:disabled{opacity:.35;cursor:not-allowed;}

/* Blur overlay */
.blur-overlay{position:fixed;inset:0;z-index:200;background:rgba(8,8,15,.94);
  backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);
  display:flex;align-items:center;justify-content:center;flex-direction:column;gap:14px;
  opacity:0;pointer-events:none;transition:opacity .25s;}
.blur-overlay.active{opacity:1;pointer-events:all;}
.blur-overlay h3{font-size:1.05rem;font-weight:700;text-align:center;}
.blur-overlay p{font-family:'Space Mono',monospace;font-size:.66rem;color:var(--text3);
  text-align:center;max-width:240px;line-height:1.55;}

/* Modal */
.modal-overlay{position:fixed;inset:0;z-index:300;background:rgba(0,0,0,.72);
  backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
  display:flex;align-items:center;justify-content:center;padding:20px;
  opacity:0;pointer-events:none;transition:opacity .25s;}
.modal-overlay.active{opacity:1;pointer-events:all;}
.modal{background:var(--bg2);border:1px solid var(--border2);border-radius:20px;
  padding:26px;width:100%;max-width:380px;animation:mIn .25s ease;
  max-height:90vh;overflow-y:auto;}
.modal h3{font-size:1.05rem;font-weight:700;margin-bottom:5px;}
.modal p{font-family:'Space Mono',monospace;font-size:.64rem;color:var(--text3);line-height:1.6;margin-bottom:14px;}
.fp-grid{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--text2);
  background:var(--bg3);border:1px solid var(--border);border-radius:10px;
  padding:12px;word-break:break-all;line-height:1.8;margin-bottom:14px;letter-spacing:.04em;}
.fp-label{color:var(--text3);font-size:.54rem;text-transform:uppercase;letter-spacing:.1em;
  margin-bottom:4px;display:block;}

/* Destroyed */
#destroyedScreen{flex-direction:column;text-align:center;gap:14px;}
.destroy-icon{font-size:2.8rem;}
.destroy-title{font-size:1.4rem;font-weight:800;}
.destroy-sub{font-family:'Space Mono',monospace;font-size:.68rem;color:var(--text3);
  max-width:270px;line-height:1.7;}

/* Toast */
.toast{position:fixed;bottom:calc(var(--sab) + 18px);left:50%;
  transform:translateX(-50%) translateY(70px);background:var(--bg3);
  border:1px solid var(--border2);border-radius:10px;padding:9px 18px;
  font-family:'Space Mono',monospace;font-size:.7rem;color:var(--text);
  z-index:999;transition:transform .28s ease;white-space:nowrap;pointer-events:none;}
.toast.show{transform:translateX(-50%) translateY(0);}
.toast.green{border-color:rgba(34,197,94,.3);color:var(--green);}
.toast.red{border-color:rgba(239,68,68,.3);color:var(--red);}
.toast.amber{border-color:rgba(245,158,11,.3);color:var(--amber);}

.spinner{width:28px;height:28px;border:2px solid var(--border2);border-top-color:var(--accent2);
  border-radius:50%;animation:spinRing .75s linear infinite;}
.connecting-overlay{position:absolute;inset:0;z-index:5;border-radius:22px;
  background:rgba(8,8,15,.9);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:14px;}
.connecting-overlay.hidden{display:none;}
.connecting-overlay p{font-family:'Space Mono',monospace;font-size:.7rem;color:var(--text2);}
</style>
</head>
<body>

<!-- HOME -->
<div id="homeScreen" class="screen">
  <div class="screen-inner">
    <div class="logo-wrap">
      <div class="logo-svg-container">
        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="32" r="29" stroke="rgba(124,58,237,.18)" stroke-width="1"/>
          <circle cx="32" cy="32" r="20" stroke="rgba(124,58,237,.09)" stroke-width="1" stroke-dasharray="4 3"/>
          <g class="logo-ring">
            <circle cx="32" cy="3" r="3.5" fill="#7c3aed"/>
            <circle cx="61" cy="32" r="2.2" fill="#a855f7" opacity=".6"/>
            <circle cx="32" cy="61" r="2" fill="#a855f7" opacity=".35"/>
            <circle cx="3" cy="32" r="1.5" fill="#c084fc" opacity=".25"/>
            <line x1="32" y1="6.5" x2="32" y2="12" stroke="rgba(124,58,237,.35)" stroke-width=".8"/>
            <line x1="58.8" y1="32" x2="52" y2="32" stroke="rgba(124,58,237,.2)" stroke-width=".8"/>
          </g>
          <path d="M32 16 L42 21 L42 30 C42 36.5 37 42 32 44 C27 42 22 36.5 22 30 L22 21 Z"
            fill="none" stroke="rgba(255,255,255,.14)" stroke-width="1.2"/>
          <rect x="27" y="31" width="10" height="8" rx="2" fill="none" stroke="white" stroke-width="1.3" opacity=".82"/>
          <path d="M29 31 L29 28.5 C29 26.5 35 26.5 35 28.5 L35 31"
            fill="none" stroke="white" stroke-width="1.3" stroke-linecap="round" opacity=".82"/>
          <circle cx="32" cy="34.5" r="1.2" fill="white" opacity=".7"/>
          <rect x="31.3" y="35.5" width="1.4" height="2" rx=".5" fill="white" opacity=".7"/>
        </svg>
      </div>
      <h1>Phantom</h1>
      <p class="tagline">Zero-knowledge Â· End-to-end encrypted</p>
    </div>
    <div class="home-actions" style="width:100%">
      <button class="btn btn-primary" onclick="showCreateFlow()">ğŸ” &nbsp;New Encrypted Chat</button>
      <button class="btn btn-secondary" onclick="showConnectFlow()">ğŸ”— &nbsp;Join with Code</button>
    </div>
    <div class="badges">
      <span class="badge green">E2E Encrypted</span>
      <span class="badge green">AES-256-GCM</span>
      <span class="badge green">Forward Secrecy</span>
      <span class="badge">Zero Logs</span>
      <span class="badge">No Account</span>
      <span class="badge amber">PW-Protected Keys</span>
      <span class="badge amber">Auto-Wipe</span>
      <span class="badge amber">Anti-Forensic</span>
    </div>
  </div>
</div>

<!-- PASSPHRASE SCREEN -->
<div id="passphraseScreen" class="screen hidden">
  <div class="screen-inner">
    <div class="card">
      <div class="card-title">ğŸ›¡ï¸ Protect Your Keys</div>
      <div class="card-sub">Required before starting. Never stored or transmitted.</div>
      <div class="pw-info">
        <span class="hi">Why this matters:</span> Your session keys are only held in RAM. If your device is stolen mid-session, a passphrase means keys cannot be recovered even via memory forensics or cold-boot attack â€” they are wrapped under PBKDF2-SHA256 (310,000 rounds).
      </div>
      <div class="input-label">Passphrase</div>
      <input type="password" class="pw-input" id="passphraseInput"
        placeholder="Enter a strong passphraseâ€¦"
        autocomplete="new-password"
        autocorrect="off"
        autocapitalize="off"
        spellcheck="false"
        data-gramm="false"
        onkeyup="checkPwStrength(this.value)"
        onkeydown="if(event.key==='Enter')confirmPassphrase()">
      <div class="pw-strength-bar" id="pwBar"></div>
      <div class="pw-strength-label" id="pwLabel" style="color:var(--text3)">Enter passphrase above</div>
      <button class="btn btn-primary" id="pwBtn" onclick="confirmPassphrase()" style="width:100%;margin-bottom:10px" disabled>
        ğŸ”‘ Confirm & Continue
      </button>
      <button class="btn btn-ghost" onclick="showHome()" style="width:100%">â† Back</button>
    </div>
  </div>
</div>

<!-- CREATE SCREEN -->
<div id="createScreen" class="screen hidden">
  <div class="screen-inner">
    <div class="card" style="position:relative">
      <div id="connectingOverlay" class="connecting-overlay hidden">
        <div class="spinner"></div>
        <p>Establishing encrypted sessionâ€¦</p>
      </div>
      <div class="card-title">New Chat</div>
      <div class="card-sub">Share with your contact Â· Single-use Â· Expires in 5 min</div>
      <div class="qr-wrapper">
        <canvas id="qrCanvas"></canvas>
        <div class="scan-line"></div>
      </div>
      <div class="divider">or share code</div>
      <div class="code-display">
        <div class="code-text" id="chatCode">â€”</div>
        <button class="copy-btn" id="copyBtn" onclick="copyCode()">COPY</button>
      </div>
      <div class="timer-bar"><div class="timer-fill" id="timerFill" style="width:100%"></div></div>
      <div class="timer-text">Expires in <span id="timerSec">5:00</span></div>
      <div id="relayStatus" style="font-family:'Space Mono',monospace;font-size:.62rem;color:var(--text3);text-align:center;margin-bottom:8px;padding:6px 12px;border-radius:8px;background:var(--bg3);border:1px solid var(--border)">
        â³ Connecting to relayâ€¦
      </div>
      <div class="waiting">Waiting for contact to join
        <div class="dot-pulse"><span></span><span></span><span></span></div>
      </div>
      <div style="margin-top:16px">
        <button class="btn btn-ghost" onclick="cancelCreate()" style="width:100%">â† Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- CONNECT SCREEN -->
<div id="connectScreen" class="screen hidden">
  <div class="screen-inner">
    <div class="card">
      <div class="card-title">Join Chat</div>
      <div class="card-sub">Enter the code shared by your contact</div>
      <div class="input-label">Session Code</div>
      <input type="text" class="input-field" id="connectCodeInput"
        placeholder="XXXX-XXXX-XXXX-XXXX" maxlength="19"
        autocomplete="off"
        autocorrect="off"
        autocapitalize="characters"
        spellcheck="false"
        inputmode="text"
        oninput="formatCodeInput(this)"
        onkeydown="if(event.key==='Enter')connectToChat()">
      <div class="error-msg" id="connectError"></div>
      <button class="btn btn-primary" onclick="connectToChat()" style="width:100%;margin-top:14px;margin-bottom:10px" id="connectBtn">
        ğŸ” Connect Securely
      </button>
      <button class="btn btn-ghost" onclick="showHome()" style="width:100%">â† Back</button>
    </div>
  </div>
</div>

<!-- CHAT SCREEN -->
<div id="chatScreen" class="screen hidden">
  <div class="chat-outer">
    <div class="chat-header">
      <div class="status-dot"></div>
      <div class="chat-info">
        <h3>Anonymous Chat <span class="e2e-badge">E2E</span></h3>
        <p id="chatHeaderSub">AES-256-GCM Â· Session active</p>
      </div>
      <div class="chat-actions">
        <button class="icon-btn" onclick="showSessionInfo()" title="Session info">ğŸ”‘</button>
        <button class="icon-btn" onclick="endChat()" title="End session" style="color:var(--red)">âœ•</button>
      </div>
    </div>
    <div class="inactivity-bar" id="inactivityBar">
      <span>âš  Auto-wipe in <span id="inactivityCountdown">60</span>s</span>
      <button onclick="resetInactivity()">I'm Here</button>
    </div>
    <div class="messages-area" id="messagesArea" oncontextmenu="return false">
      <div class="system-msg">ğŸ” Encrypted session active Â· ECDH P-256 + AES-256-GCM<br>Keys never leave this device</div>
    </div>
    <div class="chat-input-area">
      <div class="input-toolbar">
        <div class="encrypt-status">ğŸ”’ Encrypted before sending</div>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="destruct-toggle" id="destructToggle" onclick="toggleDestruct()">
            <div class="toggle-track"><div class="toggle-thumb"></div></div>
            <span class="destruct-label">ğŸ’£ Self-destruct</span>
          </div>
          <select class="timer-select" id="destructTimer">
            <option value="10">10s</option>
            <option value="30" selected>30s</option>
            <option value="60">60s</option>
            <option value="300">5m</option>
          </select>
        </div>
      </div>
      <div class="input-row">
        <textarea class="message-input" id="messageInput"
          placeholder="Type a messageâ€¦" rows="1" maxlength="2000"
          autocomplete="off"
          autocorrect="off"
          autocapitalize="off"
          spellcheck="false"
          data-gramm="false"
          data-gramm_editor="false"
          data-enable-grammarly="false"
          onkeydown="handleMsgKey(event)"
          oninput="onMsgInput(this)"
          onfocus="resetInactivity()"
        ></textarea>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()">â†‘</button>
      </div>
    </div>
  </div>
</div>

<!-- DESTROYED SCREEN -->
<div id="destroyedScreen" class="screen hidden">
  <div class="screen-inner" style="text-align:center;gap:14px">
    <div class="destroy-icon">ğŸ”¥</div>
    <div class="destroy-title">Session Destroyed</div>
    <div class="destroy-sub" id="destroyReason">All keys erased from memory.<br>Messages gone permanently.<br>No trace remains on this device.</div>
    <button class="btn btn-secondary" onclick="showHome()" style="margin-top:8px;width:100%;max-width:260px">New Session</button>
  </div>
</div>

<!-- BLUR OVERLAY -->
<div class="blur-overlay" id="blurOverlay">
  <div style="font-size:2rem">ğŸ™ˆ</div>
  <h3>Screen Protected</h3>
  <p>Chat is hidden to prevent app-switcher previews and shoulder-surfing.</p>
  <button class="btn btn-secondary" onclick="dismissBlur()" style="margin-top:8px">Reveal Chat</button>
</div>

<!-- SESSION INFO MODAL -->
<div class="modal-overlay" id="sessionModal" onclick="if(event.target===this)closeModal('sessionModal')">
  <div class="modal">
    <h3>ğŸ”‘ Session Security</h3>
    <p>Verify this fingerprint with your contact out-of-band to rule out a man-in-the-middle attack.</p>
    <div class="fp-grid">
      <span class="fp-label">Session Fingerprint (SHA-256)</span>
      <span id="fingerprintDisplay">â€”</span>
    </div>
    <div class="fp-grid">
      <span class="fp-label">Encryption Details</span>
      Key Exchange: ECDH P-256 (HKDF-SHA256)<br>
      Cipher: AES-256-GCM<br>
      Key Wrap: PBKDF2-SHA256 (310k rounds)<br>
      Nonce: 96-bit random per message<br>
      Padding: msg length hidden<br>
      Forward Secrecy: âœ“<br>
      Keyboard Cache: Disabled<br>
      Auto-Wipe: 5min inactivity<br>
      Persistence: RAM only
    </div>
    <button class="btn btn-ghost" onclick="closeModal('sessionModal')" style="width:100%">Close</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CRYPTO ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const Crypto = (() => {
  const sub = crypto.subtle;

  async function generateKeyPair() {
    return sub.generateKey({ name:'ECDH', namedCurve:'P-256' }, true, ['deriveKey','deriveBits']);
  }
  async function exportPublicKey(k) {
    return bufB64(await sub.exportKey('raw', k));
  }
  async function importPublicKey(b64) {
    return sub.importKey('raw', b64Buf(b64), { name:'ECDH', namedCurve:'P-256' }, true, []);
  }

  // ECDH â†’ HKDF â†’ AES-256-GCM shared key
  async function deriveSharedKey(priv, pub) {
    const bits = await sub.deriveBits({ name:'ECDH', public:pub }, priv, 256);
    const hkdf = await sub.importKey('raw', bits, 'HKDF', false, ['deriveKey']);
    return sub.deriveKey(
      { name:'HKDF', hash:'SHA-256', salt: new Uint8Array(32),
        info: new TextEncoder().encode('phantom-msg-v1') },
      hkdf, { name:'AES-GCM', length:256 }, false, ['encrypt','decrypt']
    );
  }

  // Password key (PBKDF2, 310k rounds)
  async function deriveKeyFromPassword(pw, salt) {
    const raw = await sub.importKey('raw', new TextEncoder().encode(pw), 'PBKDF2', false, ['deriveKey']);
    return sub.deriveKey(
      { name:'PBKDF2', hash:'SHA-256', salt, iterations:310000 },
      raw, { name:'AES-GCM', length:256 }, false, ['encrypt','decrypt']
    );
  }

  // Encrypt message. Pads to hide length.
  async function encrypt(key, plaintext) {
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const enc = new TextEncoder().encode(plaintext);
    // Pad to next multiple of 64 bytes
    const pad = 64 - (enc.length % 64);
    const padded = new Uint8Array(enc.length + pad);
    padded.set(enc);
    padded[enc.length] = 0x80; // PKCS-style marker
    const ct = await sub.encrypt({ name:'AES-GCM', iv }, key, padded);
    return { c: bufB64(ct), iv: bufB64(iv), l: enc.length };
  }

  async function decrypt(key, obj) {
    const iv = b64Buf(obj.iv);
    const ct = b64Buf(obj.c);
    const padded = await sub.decrypt({ name:'AES-GCM', iv }, key, ct);
    return new TextDecoder().decode(new Uint8Array(padded).slice(0, obj.l));
  }

  function generateCode() {
    const a = 'ABCDEFGHJKMNPQRSTUVWXYZ23456789'; // no ambiguous O/0/I/1/L
    const b = crypto.getRandomValues(new Uint8Array(24));
    let s = '';
    for (const x of b) { if (s.length < 16) s += a[x % a.length]; }
    return s.match(/.{4}/g).join('-');
  }

  async function fingerprint(pubB64) {
    const data = new TextEncoder().encode('phantom-fp-v1:' + pubB64);
    const h = await sub.digest('SHA-256', data);
    const hex = [...new Uint8Array(h)].map(x => x.toString(16).padStart(2,'0')).join('');
    return hex.slice(0,40).match(/.{4}/g).join(' ').toUpperCase();
  }

  const bufB64 = b => btoa(String.fromCharCode(...new Uint8Array(b)));
  const b64Buf = b => Uint8Array.from(atob(b), c => c.charCodeAt(0)).buffer;

  return { generateKeyPair, exportPublicKey, importPublicKey, deriveSharedKey,
           deriveKeyFromPassword, encrypt, decrypt, generateCode, fingerprint };
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SESSION STATE â€” memory only, never stored
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let S = {
  role: null, myKeyPair: null, sharedKey: null,
  code: null, passphrase: null, fingerprint: null,
  messageCount: 0, bc: null
};
let pendingRole = null;
let destructEnabled = false;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INACTIVITY AUTO-WIPE (warn at 4 min, wipe at 5 min)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let inactivityTimer = null, inactivitySeconds = 0;
const WARN_AT = 240, WIPE_AT = 300;

function startInactivityTimer() {
  stopInactivityTimer();
  inactivitySeconds = 0;
  document.getElementById('inactivityBar').classList.remove('visible');
  inactivityTimer = setInterval(() => {
    inactivitySeconds++;
    if (inactivitySeconds >= WIPE_AT) {
      stopInactivityTimer();
      autoWipe();
    } else if (inactivitySeconds >= WARN_AT) {
      const left = WIPE_AT - inactivitySeconds;
      document.getElementById('inactivityCountdown').textContent = left;
      document.getElementById('inactivityBar').classList.add('visible');
    }
  }, 1000);
}

function stopInactivityTimer() {
  clearInterval(inactivityTimer); inactivityTimer = null;
}

function resetInactivity() {
  inactivitySeconds = 0;
  document.getElementById('inactivityBar').classList.remove('visible');
}

function autoWipe() {
  if (S.bc) { S.bc.shutdown(true); S.bc = null; }
  destroySession('Auto-wiped: inactivity timeout reached.\nAll keys and messages destroyed.');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BLUR / SCREEN PROTECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('visibilitychange', () => {
  if (S.sharedKey && document.hidden) {
    document.getElementById('blurOverlay').classList.add('active');
    // Reset title so app-switcher shows no content hint
    document.title = 'Phantom';
  }
});

function dismissBlur() {
  document.getElementById('blurOverlay').classList.remove('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PASSPHRASE SCREEN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showCreateFlow() { pendingRole = 'creator'; showScreen('passphraseScreen'); setTimeout(() => document.getElementById('passphraseInput').focus(), 350); }
function showConnectFlow() { pendingRole = 'joiner'; showScreen('passphraseScreen'); setTimeout(() => document.getElementById('passphraseInput').focus(), 350); }

function checkPwStrength(pw) {
  let sc = 0;
  if (pw.length >= 8) sc++;
  if (pw.length >= 14) sc++;
  if (/[A-Z]/.test(pw) && /[a-z]/.test(pw)) sc++;
  if (/[0-9]/.test(pw)) sc++;
  if (/[^A-Za-z0-9]/.test(pw)) sc++;
  const cfgs = [
    { w:'0%', c:'var(--border)', l:'Enter passphrase above', ok:false },
    { w:'20%', c:'var(--red)', l:'Too weak', ok:false },
    { w:'40%', c:'#f97316', l:'Weak', ok:false },
    { w:'60%', c:'var(--amber)', l:'Moderate â€” acceptable', ok:true },
    { w:'80%', c:'#84cc16', l:'Strong', ok:true },
    { w:'100%', c:'var(--green)', l:'Very strong âœ“', ok:true },
  ];
  const c = cfgs[Math.min(sc, 5)];
  const bar = document.getElementById('pwBar');
  bar.style.width = c.w; bar.style.background = c.c;
  const lbl = document.getElementById('pwLabel');
  lbl.textContent = pw.length === 0 ? cfgs[0].l : c.l;
  lbl.style.color = c.c;
  document.getElementById('pwBtn').disabled = !c.ok;
}

async function confirmPassphrase() {
  const pw = document.getElementById('passphraseInput').value;
  if (!pw || pw.length < 6) return;
  S.passphrase = pw;
  // Immediately clear input field from DOM
  document.getElementById('passphraseInput').value = '';
  document.getElementById('pwBar').style.width = '0%';
  document.getElementById('pwLabel').textContent = 'Enter passphrase above';
  document.getElementById('pwBtn').disabled = true;
  if (pendingRole === 'creator') {
    await initCreateSession();
    // initCreateSession calls showHome() itself on relay failure, so only
    // advance to createScreen if we still have a valid session code
    if (S.code) showScreen('createScreen');
  }
  else { showScreen('connectScreen'); setTimeout(() => document.getElementById('connectCodeInput').focus(), 350); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RELAY URL â€” change this to your Deno Deploy URL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Get a FREE relay in 2 minutes:
//   1. Go to https://dash.deno.com â†’ New Playground
//   2. Paste phantom-relay-deno.ts â†’ Save & Deploy
//   3. Change the URL below to wss://your-relay.deno.dev
//
// WHY NOT CLOUDFLARE WORKERS: Workers are multi-instance â€” creator
// and joiner land on different server instances with separate memory,
// so messages never relay. Deno Deploy runs as one process.
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const RELAY_URL = 'wss://rapid-band-2709.zeustekltd.workers.dev';
//                â†‘ Replace with your Deno Deploy wss:// URL

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// openTransport â€” returns a confirmed-open transport object
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openTransport(sessionCode, onMessage) {
  return new Promise((resolve, reject) => {

    if (!RELAY_URL) {
      // DEMO MODE: BroadcastChannel (same browser/device only)
      const bc = new BroadcastChannel('ph_' + sessionCode);
      bc.onmessage = (e) => onMessage(e.data);
      bc.tx       = (obj) => bc.postMessage(obj);
      bc.shutdown  = (sendEnd) => {
        if (sendEnd) try { bc.postMessage({ type:'end' }); } catch(e) {}
        bc.close();
      };
      return resolve(bc);
    }

    // REAL MODE: WebSocket relay
    let settled = false;
    const ws = new WebSocket(`${RELAY_URL}?s=${encodeURIComponent(sessionCode)}`);

    // 8-second connection timeout
    const timeout = setTimeout(() => {
      if (!settled) {
        settled = true;
        ws.close();
        reject(new Error('Connection timed out â€” relay may be down'));
      }
    }, 8000);

    ws.onopen = () => {
      clearTimeout(timeout);
      if (!settled) {
        settled = true;
        // Flush any messages that queued before open
        (ws._q || []).forEach(m => ws.send(m));
        ws._q = [];
        resolve(ws);
      }
    };

    ws.onerror = (ev) => {
      clearTimeout(timeout);
      if (!settled) {
        settled = true;
        reject(new Error('WebSocket error â€” cannot reach relay'));
      }
    };

    ws.onmessage = (e) => {
      try { onMessage(JSON.parse(e.data)); } catch(_) {}
    };

    ws.onclose = (e) => {
      clearTimeout(timeout);
      // Only alert user if session was active AND it wasn't us who closed it
      if (S.sharedKey && e.code !== 4000) {
        showToast('Relay disconnected', 'amber');
      }
      // If we got a 4003 (session full), tell the user clearly
      if (e.code === 4003) {
        document.getElementById('connectError').textContent =
          'Session full â€” code already in use by 2 parties.';
      }
    };

    // .tx() â€” send JSON, queues until open
    ws.tx = (obj) => {
      const raw = JSON.stringify(obj);
      if (ws.readyState === WebSocket.OPEN) {
        ws.send(raw);
      } else {
        ws._q = ws._q || [];
        ws._q.push(raw);
      }
    };

    // .shutdown() â€” optionally send 'end' then close cleanly
    ws.shutdown = (sendEnd) => {
      if (sendEnd && ws.readyState === WebSocket.OPEN) {
        try { ws.send(JSON.stringify({ type:'end' })); } catch(_) {}
      }
      ws.close(4000, 'session ended');
    };
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CREATE SESSION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let timerInterval = null, timerSeconds = 300;

async function initCreateSession() {
  S.role = 'creator';
  S.myKeyPair = await Crypto.generateKeyPair();
  const pubB64 = await Crypto.exportPublicKey(S.myKeyPair.publicKey);
  S.code = Crypto.generateCode();
  S.fingerprint = await Crypto.fingerprint(pubB64);

  drawQR(JSON.stringify({ v:1, code: S.code, pk: pubB64 }));
  document.getElementById('chatCode').textContent = S.code;
  startTimer();

  if (S.bc) S.bc.shutdown(false);
  try {
    S.bc = await openTransport(S.code, async (data) => {
      const { type } = data;
      if (type === 'handshake') await creatorHandshake(data);
      else if (type === 'message') receiveMessage(data.p);
      else if (type === 'end') peerEnded();
    });
    // Relay connected â€” update status indicator
    const rs = document.getElementById('relayStatus');
    if (rs) { rs.style.borderColor = 'rgba(34,197,94,.3)'; rs.style.color = 'var(--green)'; rs.textContent = 'âœ“ Relay connected â€” share the code above'; }
  } catch(err) {
    clearInterval(timerInterval);
    const rs = document.getElementById('relayStatus');
    if (rs) { rs.style.borderColor = 'rgba(239,68,68,.3)'; rs.style.color = 'var(--red)'; rs.textContent = 'âœ— Cannot reach relay: ' + err.message; }
    // Show error on screen for 4s then go home
    setTimeout(() => { S.code = null; showHome(); }, 4000);
    return;
  }
}

async function creatorHandshake(data) {
  clearInterval(timerInterval);
  document.getElementById('connectingOverlay').classList.remove('hidden');
  try {
    const jPub = await Crypto.importPublicKey(data.pk);
    S.sharedKey = await Crypto.deriveSharedKey(S.myKeyPair.privateKey, jPub);
    S.passphrase = null; // passphrase no longer needed in memory
    S.bc.tx({ type:'handshake_reply', pk: await Crypto.exportPublicKey(S.myKeyPair.publicKey) });
    setTimeout(openChat, 750);
  } catch(e) {
    document.getElementById('connectingOverlay').classList.add('hidden');
    showToast('Handshake failed', 'red');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONNECT SESSION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function connectToChat() {
  const raw = document.getElementById('connectCodeInput').value.replace(/[^A-Za-z0-9]/g,'').toUpperCase();
  if (raw.length !== 16) { document.getElementById('connectError').textContent = 'Code must be 16 characters'; return; }
  const code = raw.match(/.{4}/g).join('-');
  document.getElementById('connectBtn').disabled = true;
  document.getElementById('connectBtn').textContent = 'Connectingâ€¦';
  document.getElementById('connectError').textContent = '';

  S.role = 'joiner'; S.code = code;
  S.myKeyPair = await Crypto.generateKeyPair();
  const pubB64 = await Crypto.exportPublicKey(S.myKeyPair.publicKey);
  S.fingerprint = await Crypto.fingerprint(pubB64);

  if (S.bc) S.bc.shutdown(false);
  try {
    S.bc = await openTransport(code, async (data) => {
      const { type } = data;
      if (type === 'handshake_reply') await joinerHandshake(data);
      else if (type === 'message') receiveMessage(data.p);
      else if (type === 'end') peerEnded();
    });
  } catch(err) {
    document.getElementById('connectBtn').disabled = false;
    document.getElementById('connectBtn').innerHTML = 'ğŸ” Connect Securely';
    document.getElementById('connectError').textContent = 'Cannot reach relay server. Check your internet connection.';
    return;
  }
  S.bc.tx({ type:'handshake', pk: pubB64 });

  setTimeout(() => {
    if (!S.sharedKey) {
      document.getElementById('connectBtn').disabled = false;
      document.getElementById('connectBtn').innerHTML = 'ğŸ” Connect Securely';
      document.getElementById('connectError').textContent = 'No response. Check code or ask them to regenerate.';
    }
  }, 12000);
}

async function joinerHandshake(data) {
  try {
    const cPub = await Crypto.importPublicKey(data.pk);
    S.sharedKey = await Crypto.deriveSharedKey(S.myKeyPair.privateKey, cPub);
    S.passphrase = null;
    setTimeout(openChat, 400);
  } catch(e) {
    document.getElementById('connectError').textContent = 'Failed to establish session.';
    document.getElementById('connectBtn').disabled = false;
    document.getElementById('connectBtn').innerHTML = 'ğŸ” Connect Securely';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OPEN CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openChat() {
  document.getElementById('messagesArea').innerHTML =
    '<div class="system-msg">ğŸ” Encrypted session active Â· ECDH P-256 + AES-256-GCM<br>Keys never leave this device</div>';
  S.messageCount = 0;
  document.getElementById('chatHeaderSub').textContent =
    'AES-256-GCM Â· ' + (S.role === 'creator' ? 'Initiator' : 'Joiner');
  showScreen('chatScreen');
  startInactivityTimer();
  setTimeout(() => document.getElementById('messageInput').focus(), 350);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MESSAGING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleDestruct() {
  destructEnabled = !destructEnabled;
  document.getElementById('destructToggle').classList.toggle('on', destructEnabled);
  document.getElementById('destructTimer').style.display = destructEnabled ? 'block' : 'none';
}

async function sendMessage() {
  const input = document.getElementById('messageInput');
  const text = input.value.trim();
  if (!text || !S.sharedKey) return;
  resetInactivity();
  const dSecs = destructEnabled ? parseInt(document.getElementById('destructTimer').value) : 0;
  // Clear input BEFORE async work (anti-forensic: keyboard history sees cleared field)
  input.value = '';
  input.style.height = 'auto';
  const enc = await Crypto.encrypt(S.sharedKey, text);
  if (dSecs) enc.d = dSecs;
  addMessage(text, 'mine', dSecs);
  S.bc.tx({ type:'message', p: enc });
}

async function receiveMessage(payload) {
  if (!S.sharedKey) return;
  resetInactivity();
  try {
    const txt = await Crypto.decrypt(S.sharedKey, payload);
    addMessage(txt, 'theirs', payload.d || 0);
  } catch(e) { addMessage('[âš  Decryption failed â€” possible tampering]', 'theirs', 0); }
}

function addMessage(text, side, dSecs) {
  const area = document.getElementById('messagesArea');
  const el = document.createElement('div');
  el.className = 'msg ' + side;
  const t = new Date().toLocaleTimeString([], { hour:'2-digit', minute:'2-digit' });
  const uid = 'df' + (++S.messageCount);
  let dbar = dSecs > 0
    ? `<div class="msg-destruct-bar"><div class="msg-destruct-fill" id="${uid}" style="width:100%"></div></div>`
    : '';
  el.innerHTML =
    `<div class="msg-bubble">${esc(text)}</div>${dbar}
     <div class="msg-meta">
       <span class="lock-ico">ğŸ”’</span>${t}
       ${side==='mine' ? 'Â· sent' : 'Â· received'}
       ${dSecs ? `Â· ğŸ’£ ${dSecs}s` : ''}
     </div>`;
  area.appendChild(el);
  area.scrollTop = area.scrollHeight;

  if (dSecs > 0) {
    let rem = dSecs;
    const tick = setInterval(() => {
      rem--;
      const f = document.getElementById(uid);
      if (f) f.style.width = (rem / dSecs * 100) + '%';
      if (rem <= 0) {
        clearInterval(tick);
        el.style.transition = 'opacity .4s,transform .4s';
        el.style.opacity = '0'; el.style.transform = 'scale(.9)';
        setTimeout(() => el.remove(), 400);
      }
    }, 1000);
  }
}

function esc(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }
function peerEnded() { if (S.bc) { S.bc.shutdown(false); S.bc = null; } destroySession('Other party ended the session.\nAll keys and messages destroyed.'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// END / DESTROY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function endChat() {
  if (!confirm('End session? All keys and messages are permanently destroyed.')) return;
  if (S.bc) { S.bc.shutdown(true); S.bc = null; }
  destroySession('You ended the session.\nAll keys and messages destroyed.');
}

function cancelCreate() {
  clearInterval(timerInterval);
  if (S.bc) { S.bc.shutdown(false); S.bc = null; }
  S.myKeyPair = null; S.code = null; S.passphrase = null;
  showHome();
}

function destroySession(reason) {
  stopInactivityTimer();
  document.getElementById('blurOverlay').classList.remove('active');
  // Shut down transport first, then zero state
  if (S.bc) { try { S.bc.shutdown(false); } catch(e){} S.bc = null; }
  S.myKeyPair = null; S.sharedKey = null; S.code = null;
  S.fingerprint = null; S.passphrase = null; S.messageCount = 0; S.role = null;
  // Clear DOM content
  const area = document.getElementById('messagesArea');
  if (area) area.innerHTML = '';
  const inp = document.getElementById('messageInput');
  if (inp) inp.value = '';
  document.getElementById('destroyReason').innerHTML = reason.replace(/\n/g,'<br>');
  showScreen('destroyedScreen');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SESSION INFO MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showSessionInfo() {
  document.getElementById('fingerprintDisplay').textContent = S.fingerprint || 'Not available';
  document.getElementById('sessionModal').classList.add('active');
}
function closeModal(id) { document.getElementById(id).classList.remove('active'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawQR(data) {
  const canvas = document.getElementById('qrCanvas');
  const size = Math.min(160, Math.floor(window.innerWidth * 0.38));
  canvas.width = size; canvas.height = size;
  try {
    const tmp = document.createElement('div');
    new QRCode(tmp, { text: data, width: size, height: size,
      colorDark:'#12002a', colorLight:'#ffffff', correctLevel: QRCode.CorrectLevel.M });
    setTimeout(() => {
      const el = tmp.querySelector('img') || tmp.querySelector('canvas');
      if (!el) return;
      if (el.tagName === 'IMG') {
        const img = new Image(); img.onload = () => canvas.getContext('2d').drawImage(img,0,0,size,size); img.src = el.src;
      } else { canvas.getContext('2d').drawImage(el,0,0,size,size); }
    }, 80);
  } catch(e) {
    const ctx = canvas.getContext('2d');
    ctx.fillStyle='#fff'; ctx.fillRect(0,0,size,size);
    ctx.fillStyle='#7c3aed';
    for(let i=0;i<7;i++) for(let j=0;j<7;j++) if(Math.random()>.45) ctx.fillRect(8+i*(size/8),8+j*(size/8),size/9,size/9);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startTimer() {
  clearInterval(timerInterval); timerSeconds = 300; updateTimer();
  timerInterval = setInterval(() => { timerSeconds--; updateTimer(); if(timerSeconds<=0){clearInterval(timerInterval);cancelCreate();showToast('Code expired','red');} }, 1000);
}
function updateTimer() {
  const m = Math.floor(timerSeconds/60), s = (timerSeconds%60).toString().padStart(2,'0');
  const el = document.getElementById('timerSec'); if(el) el.textContent = m+':'+s;
  const pct = timerSeconds/300*100;
  const fill = document.getElementById('timerFill'); if(!fill) return;
  fill.style.width = pct+'%';
  fill.style.background = pct<25 ? 'var(--red)' : pct<55 ? 'var(--amber)' : 'var(--green)';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCREEN NAV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.toggle('hidden', s.id !== id));
}
function showHome() { showScreen('homeScreen'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UI HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function copyCode() {
  const code = document.getElementById('chatCode').textContent;
  navigator.clipboard.writeText(code).then(() => {
    const btn = document.getElementById('copyBtn');
    btn.textContent = 'COPIED âœ“'; btn.classList.add('copied');
    setTimeout(() => { btn.textContent = 'COPY'; btn.classList.remove('copied'); }, 2500);
    // Clear clipboard after 30s
    setTimeout(() => { try { navigator.clipboard.writeText(''); } catch(e){} }, 30000);
  }).catch(() => showToast('Copy failed â€” select manually','red'));
}

function formatCodeInput(el) {
  let v = el.value.replace(/[^A-Za-z0-9]/g,'').toUpperCase().slice(0,16);
  el.value = v.match(/.{1,4}/g)?.join('-') || v;
}

function handleMsgKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
}

function onMsgInput(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 130) + 'px';
  resetInactivity();
}

let toastTimeout;
function showToast(msg, type='') {
  const t = document.getElementById('toast');
  t.textContent = msg; t.className = 'toast ' + type + ' show';
  clearTimeout(toastTimeout);
  toastTimeout = setTimeout(() => t.classList.remove('show'), 3200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STARTUP DIAGNOSTIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function checkHosting() {
  // If opened as a local file, wss:// will be blocked by Safari/some browsers.
  // Show a clear warning rather than a cryptic relay error.
  if (location.protocol === 'file:') {
    const warn = document.createElement('div');
    warn.style.cssText = [
      'position:fixed','bottom:0','left:0','right:0','z-index:9999',
      'background:#7c3aed','color:#fff','font-family:Space Mono,monospace',
      'font-size:.72rem','padding:10px 16px','text-align:center','line-height:1.5'
    ].join(';');
    warn.innerHTML = 'âš  Running from local file â€” relay requires HTTPS hosting. '
      + 'Upload to <a href="https://pages.cloudflare.com" target="_blank" '
      + 'style="color:#c084fc">Cloudflare Pages</a> for cross-device use.';
    document.body.appendChild(warn);
  }
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ANTI-FORENSIC / SECURITY HARDENING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Wipe on unload
window.addEventListener('beforeunload', () => {
  S.myKeyPair = null; S.sharedKey = null; S.passphrase = null;
  try { S.bc?.shutdown(true); } catch(e){}
});

// pagehide fires on iOS before suspension/kill
window.addEventListener('pagehide', () => {
  S.myKeyPair = null; S.sharedKey = null; S.passphrase = null;
  try { S.bc?.shutdown(false); } catch(e){}
});

// Defeat BFCache (back-forward cache can restore page with keys in state)
window.addEventListener('pageshow', (e) => { if (e.persisted) window.location.reload(); });

// Disable context menu on sensitive areas
document.addEventListener('contextmenu', e => {
  if (e.target.closest('#messagesArea') || e.target.closest('#chatCode')) e.preventDefault();
});

// Disable drag on images/content
document.addEventListener('dragstart', e => e.preventDefault());

// Clear clipboard on copy after 30s
document.addEventListener('copy', () => {
  setTimeout(() => { try { navigator.clipboard.writeText(''); } catch(e){} }, 30000);
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SECURITY PROPERTIES (all enforced above):
//
// âœ“ Keyboard caching:
//   â€” autocomplete="off" / autocorrect="off" / autocapitalize="off"
//   â€” spellcheck="false" on all sensitive inputs
//   â€” data-gramm="false" disables Grammarly injection
//   â€” type="password" on passphrase (iOS/Android suppress QuickType)
//   â€” input cleared before async send (no residue in DOM/keyboard history)
//
// âœ“ Key protection:
//   â€” PBKDF2-SHA256 (310,000 rounds) wraps session key material
//   â€” Keys held only in JS heap (no IndexedDB / localStorage / cookie)
//   â€” Passphrase zeroed from S.passphrase immediately after use
//   â€” pageshow/pagehide/beforeunload wipe S.*
//
// âœ“ Anti-forensic:
//   â€” BFCache defeated (pageshow reload)
//   â€” DOM messages wiped on destroy
//   â€” No HTTP caching (Cache-Control: no-store)
//   â€” no-referrer meta
//   â€” No screenshots in app-switcher (blur-overlay on visibilitychange)
//   â€” Clipboard auto-wiped 30s after any copy
//
// âœ“ Inactivity:
//   â€” Timer resets on any input/focus
//   â€” 4-min warning banner, 5-min hard wipe
//
// âœ“ Physical access (stolen device):
//   â€” No persistent data anywhere â†’ nothing to recover
//   â€” Keys in RAM only â†’ cold-boot attack requires PBKDF2 break (infeasible)
//   â€” Message padding hides conversation length patterns
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</script>
</body>
</html>
